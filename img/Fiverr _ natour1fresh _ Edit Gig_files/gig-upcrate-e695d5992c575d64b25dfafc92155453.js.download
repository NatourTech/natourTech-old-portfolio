this.Fiverr=this.Fiverr||{},this.Fiverr.Templates=this.Fiverr.Templates||{},this.Fiverr.Templates["popups/popup-gig-examples"]=Handlebars.template({1:function(e,t,a,i){var r,n=t.helperMissing,s="function",o=this.escapeExpression;return'                    <li class="js-popup-tab" data-tab="'+o((r=null!=(r=t.id||(null!=e?e.id:e))?r:n,typeof r===s?r.call(e,{name:"id",hash:{},data:i}):r))+'">'+o((r=null!=(r=t.title||(null!=e?e.title:e))?r:n,typeof r===s?r.call(e,{name:"title",hash:{},data:i}):r))+"</li>\n"},3:function(e,t,a,i){var r,n;return'                <div class="f-slider js-data-'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"id",hash:{},data:i}):n))+'">\n                    <a class="slider-nav nav-prev js-slider-nav inactive" rel="nofollow"><span><i class="fa fa-angle-left"></i></span></a>\n                    <a class="slider-nav nav-next js-slider-nav" rel="nofollow"><span><i class="fa fa-angle-right"></i></span></a>\n\n                    <div class="slider-box">\n                        <div class="slider-hider">\n'+(null!=(r=this.invokePartial(a["gig-examples-slides"],e,{name:"gig-examples-slides",hash:{tab:e},data:i,indent:"                            ",helpers:t,partials:a}))?r:"")+"                        </div>\n                    </div>\n                </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var r,n=t.helperMissing;return'<section class="popup-base popup-gig-examples">\n    <header>\n        <a href="#" class="btn-close js-btn-close">&times;</a>\n        <h2>'+(null!=(r=(t.getI18nText||e&&e.getI18nText||n).call(e,"manage_gigs.new.gig_examples",{name:"getI18nText",hash:{},data:i}))?r:"")+'</h2>\n    </header>\n    <div class="popup-content">\n        <aside>\n            <ul class="js-popup-tabs">\n'+(null!=(r=t.each.call(e,null!=e?e.tabs:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'            </ul>\n        </aside>\n        <div class="display-area content-visible cf js-display-area">\n'+(null!=(r=t.each.call(e,null!=e?e.tabs:e,{name:"each",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?r:"")+'        </div>\n        <footer>\n            <a href="#!" class="btn-standard btn-green-grad js-btn-close">'+this.escapeExpression((t.getI18nText||e&&e.getI18nText||n).call(e,"general.got_it",{name:"getI18nText",hash:{},data:i}))+"</a>\n        </footer>\n    </div>\n</section>\n"},usePartial:!0,useData:!0}),this.Fiverr=this.Fiverr||{},this.Fiverr.Templates=this.Fiverr.Templates||{},this.Fiverr.Templates["popups/popup-gig-examples-slides"]=Handlebars.template({1:function(e,t,a,i,r,n){var s,o=t.helperMissing;return'    <div class="slide slide-'+this.escapeExpression(this.lambda(null!=n[1]?n[1].id:n[1],e))+'">\n'+(null!=(s=(t.singleIf||e&&e.singleIf||o).call(e,null!=n[1]?n[1].id:n[1],"title",{name:"singleIf",hash:{},fn:this.program(2,i,0,r,n),inverse:this.noop,data:i}))?s:"")+(null!=(s=(t.singleIf||e&&e.singleIf||o).call(e,null!=n[1]?n[1].id:n[1],"packages",{name:"singleIf",hash:{},fn:this.program(4,i,0,r,n),inverse:this.noop,data:i}))?s:"")+"\n    </div>\n"},2:function(e,t,a,i){var r,n,s=t.helperMissing,o="function";return"            <h1>"+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:s,typeof n===o?n.call(e,{name:"title",hash:{},data:i}):n))+'</h1>\n            <div class="wrapper">\n                <header><h4 class="gig-fancy-header">Description</h4></header>\n                <div class="gig-main-desc">\n                    <p>'+(null!=(n=null!=(n=t.description||(null!=e?e.description:e))?n:s,r=typeof n===o?n.call(e,{name:"description",hash:{},data:i}):n)?r:"")+"</p>\n                </div>\n            </div>\n"},4:function(e,t,a,i){var r;return"                "+(null!=(r=this.lambda(e,e))?r:"")+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i,r,n){var s;return null!=(s=t.each.call(e,null!=(s=null!=e?e.tab:e)?s.data:s,{name:"each",hash:{},fn:this.program(1,i,0,r,n),inverse:this.noop,data:i}))?s:""},useData:!0,useDepths:!0}),function(){fPopupExamples={models:{c:Fiverr.models.context,b:Fiverr.models.browser,user:Fiverr.models.user,tabs:document.pageScope.gig_examples,examples_url:document.pageScope.gig_examples_url,category_id:document.pageScope.categories.initial_id,sub_category_id:document.pageScope.subcategories.initial_id,sliderPointers:{},allDataLoaded:{},pageSize:5},selectors:{$dbEditGig:$(".js-db-edit-gig")},init:function(){e.dropEmptyTabs(),a.$dbEditGig.on("click",".js-open-examples-popup",function(a){t.selectedTabId=$(a.target).attr("data-tab"),e.openPopup(t.selectedTabId)}),e.showExampleLinks(a.$dbEditGig)},openPopup:function(t){return a.$eduPopup?(a.$eduPopup.bPopup({closeClass:"js-btn-close",follow:[!1,!1],opacity:.6}),void e.showTabWithId(t)):void e.createPopup(t)},createPopup:function(i){Fiverr._getHbTemplate({tplType:"popups",tplName:"popup-gig-examples",tplData:{tabs:t.tabs},dependencies:["//assetsv2.fiverrcdn.com/assets/desktop/popups/popup-gig-examples-48f7865e3ce954208ba1c97550311a41.css"],callback:function(t){a.$eduPopup=$(t),$("body").append(a.$eduPopup),e.bindTabEvents(),e.openPopup(i)}})},showTabWithId:function(e){e||(t.selectedTabId=_.head(t.tabs).id),a.$displayArea.removeClass("content-visible"),_.delay(function(){a.$displayArea.addClass("content-visible")},100),a.$tabsWrapper.find(".js-popup-tab").removeClass("active"),a.$tabsWrapper.find('.js-popup-tab[data-tab="'+t.selectedTabId+'"]').addClass("active"),a.$displayArea.find("[class*='js-data-']").removeClass("active"),a.$displayArea.find(".js-data-"+t.selectedTabId).addClass("active")},refreshPopup:function(t,i){e.updateCategoryData(t,i),a.$eduPopup&&e.removePopup(),e.loadData()},showExampleLinks:function(e){e.find(".open-examples-popup").addClass("hidden"),_.each(t.tabs,function(t){e.find('.js-open-examples-popup[data-tab="'+t.id+'"]').removeClass("hidden")})},updateCategoryData:function(e,a){t.category_id=e,t.sub_category_id=a},removePopup:function(){a.$eduPopup.find(".js-btn-close").trigger("click"),a.$eduPopup.remove(),delete a.$eduPopup},initSelectorsAndSlider:function(){a.$tabsWrapper=$(".js-popup-tabs"),a.$tabs=$(".js-popup-tab"),a.$displayArea=$(".js-display-area"),$(".f-slider").fSlider({slideWidth:544,fade:!0,setTallestSlideHeight:!0,onMove:function(a,i,r){if(-1!=r.target.className.indexOf(" sel")){t.sliderPointers[t.selectedTabId]=a;var n=_.filter(t.tabs,{id:t.selectedTabId})[0],s=n.data.length;a!=s-2||t.allDataLoaded[t.selectedTabId]||"next"!==i||e.loadData(n)}}})},bindTabEvents:function(){e.initSelectorsAndSlider(),a.$tabs.on("click",function(a){t.selectedTabId=$(a.target).attr("data-tab"),e.showTabWithId(t.selectedTabId)}),$("body").on("keydown",function(e){a.$eduPopup.is(":hidden")||("38"==e.keyCode?(e.preventDefault(),a.$tabsWrapper.find('.js-popup-tab[data-tab="'+t.selectedTabId+'"]').prev("li").trigger("click")):"40"==e.keyCode?(e.preventDefault(),a.$tabsWrapper.find('.js-popup-tab[data-tab="'+t.selectedTabId+'"]').next("li").trigger("click")):"37"==e.keyCode?a.$displayArea.find(".js-data-"+t.selectedTabId).find(".nav-prev").not(".inactive").trigger("click"):"39"==e.keyCode&&a.$displayArea.find(".js-data-"+t.selectedTabId).find(".nav-next").not(".inactive").trigger("click"))})},buildTemplate:function(e){var t=Fiverr._getHbTemplate({tplType:"popups",tplName:"popup-gig-examples-slides",tplData:{tab:e,id:e.id}});return t},loadData:function(i){var r=i?i.data.length:0;$.ajax({url:document.pageScope.gig_examples_url,type:"GET",dataType:"json",data:{category_id:t.category_id,sub_category_id:t.sub_category_id,size:t.pageSize,offset:r}}).done(function(i){0===i.errors.length&&(a.$eduPopup?(e.appendDataToModel(i),e.appendDataToDom(i)):(t.tabs=_.clone(i.data),e.dropEmptyTabs(),e.showExampleLinks(a.$dbEditGig)))}).fail(function(){Fiverr._logErrorToServer("global-popup-examples.js","loadData","[examples popup] could not get gig examples")})},appendDataToModel:function(e){_.each(t.tabs,function(a){e.data[a.id].data.length<t.pageSize&&1==t.allDataLoaded[a.id],a.data.concat(e.data[a.id].data)})},appendDataToDom:function(t){_.each(t.data,function(t){var i=e.buildTemplate(t);a.$displayArea.find(".js-data-"+t.id).find(".slider-hider").append(i)})},dropEmptyTabs:function(){var e=[];_.each(t.tabs,function(t,a){t.data.length&&e.push(t)}),t.tabs=e}};var e=fPopupExamples,t=e.models,a=e.selectors;$(document).ready(fPopupExamples.init)}(jQuery),Handlebars.registerPartial("gig-examples-slides",Fiverr.Templates["popups/popup-gig-examples-slides"]),function(e){var t,a,i,r,n={TITLE_MIN_CHARS:15,TITLE_MAX_CHARS:80,TITLE_MIN_WORDS:4,TITLE_MAX_WORDS:15,SEO_TITLE_MIN_CHARS:5,SEO_TITLE_MAX_CHARS:50,TAGS_LIST_MIN:3,DESC_MIN_CHARS:120,DESC_MAX_CHARS:1200,GALLERY_MIN_IMAGES:1,EXTRAS_MIN_CHARS:2,EXTRAS_MAX_CHARS:20,MAX_NUM_PACKAGE_CUSTOMS:2,EXTRA_TITLE_MAX_CHARS:100,MIN_REQUIREMENTS:1,MIN_LENGTH_AUDIO_TITLE:50,ACADEMIC_DISCLAIMER_SUBCAT_IDS:[169,413]},s={TITLE_REPEATED_CHARS:/(.)(\1)(\2)(\3)/gi},o={formatError:function(e,t){return t.length>0?{field:e,messages:t}:null},"gig[title]":function(t){var a=[],i=_.trim(t.value);return i.length<n.TITLE_MIN_CHARS&&a.push(e.t("manage_gigs.form.error.title")),i.length>n.TITLE_MAX_CHARS&&a.push(e.t("manage_gigs.form.error.title_long")),i.split(" ").length<n.TITLE_MIN_WORDS&&a.push(e.t("manage_gigs.form.error.title_words")),i.split(" ").length>n.TITLE_MAX_WORDS&&a.push(e.t("manage_gigs.form.error.title_words_long")),i.match(s.TITLE_REPEATED_CHARS)&&a.push(e.t("manage_gigs.form.error.title_duplicate_characters")),o.formatError(t,a)},"gig[seo_title]":function(t){var a=[],i=_.trim(t.value),r=e(t).closest(".js-field-seo-title").hasClass("hidden");return r||(i.length<n.SEO_TITLE_MIN_CHARS&&a.push(e.t("manage_gigs.form.error.seo_title")),i.length>n.SEO_TITLE_MAX_CHARS&&a.push(e.t("manage_gigs.form.error.seo_title_long"))),o.formatError(t,a)},"gig[category_id]":function(t){var a=[],n=r.$sectionTitle||e(".js-gallery-wrapper .section-title-component");return i.chosen_category_id=_.parseInt(t.value,10),12!==i.chosen_category_id?n.find(".page-alert-wrap").remove():i.chosen_category_id||a.push(e.t("manage_gigs.form.error.category")),o.formatError(t,a)},"gig[sub_category_id]":function(t){var r=[],n=_.parseInt(t.value,10),s=a.getChosenCategoryID(),d=a.getChosenSubCategoryID(),g=Fiverr.models.ps.categories.initial_id,l=Fiverr.models.ps.subcategories.list,c=s!==g,p=function(e){return e.id===d};return i.chosen_sub_category_id=_.parseInt(t.value,10),a.getChosenCategoryID()&&!n&&r.push(e.t("manage_gigs.form.error.category")),"edit"!==Fiverr.models.ps.sub||l.some(p)||c||r.push(e.t("manage_gigs.form.error.subcat_unavailable")),o.formatError(t,r)},description:function(t){if(!t)return null;var a=[],i=r.$form.find('[name="gig[description]"]'),s=i.get(0),d=_.trim(i.siblings("iframe").contents().find("body").text());return s?(d.length<n.DESC_MIN_CHARS&&a.push(e.t("manage_gigs.form.error.description_short")),d.length>n.DESC_MAX_CHARS&&a.push(e.t("manage_gigs.form.error.description_long")),o.formatError(s,a)):null},metadata:function(){var t=[],i=r.$form.find(".js-metadata-edit"),n=i.find(".metadata-required-msg"),s=0,d=_.get(fEditGig,"models.gig_attributes.extended",[]).filter(function(e){return e.required}).map(function(e){return e._id}),g=_.every(d,a.isMetadataHasValue);if(!g)return o.formatError(n,[e.t("manage_gigs.form.error.required_metadata")]);if(e(".js-multi-pairs-hidden-input").length){var l=e(".js-multi-pairs-hidden-input"),c=_.chunk(l,2),p={};_.forEach(c,function(t){p=e(t),p.eq(0).val().length&&!p.eq(1).val().length?s++:!p.eq(0).val().length&&p.eq(1).val().length&&s++}),s&&t.push(e.t("manage_gigs.form.error.empty_meta_pair"))}return o.formatError(i,t)},gallery:function(a){var i=[],r=e(".section-errors"),n=document.reactGalleryData.api;return a&&i.push(a),n.validate(),i=i.concat(n.validationErrors),i.length>0&&t.scrollToError(r.position().top),o.formatError(r,i)},studio_services:function(){var t=[],a=e(".section-errors"),i=window.GigUpcrateStudioServices.isValid;return i||t.push(["Error"]),o.formatError(a,t)},studio_pricing:function(){var t,a=[],i=window.studio_gig_pricing_output.is_valid,r="gig_upcrate::pricing::validate";return"function"==typeof window.CustomEvent?t=new CustomEvent(r):(t=document.createEvent("CustomEvent"),t.initCustomEvent(r,!1,!1)),document.dispatchEvent(t),i||a.push(["Error"]),o.formatError(e(document),a)},extras:function(){var t=r.$form.find('input[name*="gig[gig_items_attributes]"][name*="[active]"]:checked'),a=[],i=[],s=0;return t.each(function(t){var d=[],g=e(this),t=_.parseInt(this.name.replace(/gig\[gig_items_attributes\]\[/g,"").replace(/\]\[active\]/g,""),10),l=_.parseInt(g.closest(".item-row, .gig-extra").find('[name*="expected_duration"]').val(),10);if(t===fEditGig.models.extraFastRandInd?l?l>=_.parseInt(r.$form.find('[name="gig[expected_duration]"]').val(),10)&&d.push(e.t("manage_gigs.form.error.gig_extrafastlonger_error")):d.push(e.t("manage_gigs.form.error.gig_extrafast_error")):($itemGigExtra=g.closest(".item-row, .gig-extra"),$inpTitle=$itemGigExtra.find(".js-extra-title"),$inpDescription=$itemGigExtra.find(".js-extra-description"),$includedOfferingsStandard=$itemGigExtra.find(".js-includes-extra-standard").prop("checked"),$includedOfferingsPremium=$itemGigExtra.find(".js-includes-extra-premium").prop("checked"),$includedPackageOfferings=$includedOfferingsStandard||$includedOfferingsPremium||!1,$includedPackageOfferings&&(s++,$inpTitle.val()||d.push(e.t("manage_gigs.form.error.gig_extra_title_short_missing_error")),s>n.MAX_NUM_PACKAGE_CUSTOMS&&d.push(e.t("manage_gigs.form.error.gig_package_extra_max_number_error"))),$inpTitle.val()&&(_.trim($inpTitle.val()).length<n.EXTRAS_MIN_CHARS?d.push(e.t("manage_gigs.form.error.gig_extra_title_short_error")):_.trim($inpTitle.val()).length>n.EXTRAS_MAX_CHARS&&d.push(e.t("manage_gigs.form.error.gig_extra_title_long_error")),i.push($inpTitle.val())),$inpDescription.val()&&(_.trim($inpDescription.val()).length<=n.EXTRAS_MIN_CHARS&&d.push(e.t("manage_gigs.form.error.gig_extra_description_error")),_.trim($inpDescription.val()).length>=n.EXTRA_TITLE_MAX_CHARS&&d.push(e.t("manage_gigs.form.error.gig_extra_title_extra_chars_error")))),i.length>=2){var c=i.sort();_.uniq(c).length!==c.length&&d.push(e.t("manage_gigs.form.error.gig_extra_unique_title"))}a.push(o.formatError($itemGigExtra,d))}),_.flatten(a)},shipping:function(t){var a=[],i=r.$form.find(".js-shipping"),n=i.find('[name="gig[is_shippable]"]'),s=i.find('[name="gig[local_shipping_price_p]"]');return n.is(":checked")&&!_.parseInt(s.val(),10)&&a.push(e.t("manage_gigs.form.error.gig_shippingprice")),o.formatError(s,a)},expectedDuration:function(t){var a=r.$form.find('[name="gig[expected_duration]"]'),i=r.$form.find("td.js-packages-expected-duration"),n=[];return"packages"===fEditGig.models.gig_pricing.mode?o.formatError(a,n):(_.parseInt(a.val(),10)||(n.push(e.t("manage_gigs.form.error.duration")),i.addClass("with-error")),o.formatError(a,n))},extraFastDuration:function(){var t=0,a={},i=r.$form.find(".js-extra-fast"),n=i.find(".title").text();i.removeClass("with-error");for(var s=1;4>s;s++){var o=r.$form.find('[name="gig[packages]['+s+'][content][8765][expected_duration]"]'),d=r.$form.find('[name="gig[packages]['+s+'][content][8765][price]"]'),g=e('td.js-packages-expected-duration[data-package="'+s+'"]'),l=o.closest(".fake-dropdown").find("a"),c=parseInt(r.$form.find('[name="gig[packages]['+s+'][duration]"]').val()),p=parseInt(o.val()),u=parseInt(d.val());p&&c&&p>=c?(t++,g.addClass("with-error"),l.addClass("with-error"),a.messages=e.t("manage_gigs.form.error.gig_extrafastlonger_error")):l.removeClass("with-error"),p&&!u&&(t++,a.messages=e.t("manage_gigs.edit.gig_and_packages.validation.gig_extra_price_empty",{item_name:n}))}return t&&i.addClass("with-error"),a},packagesMode:function(a){var i=fPackagesEdit,r=i.models,n=i.selectors,s={},d="save"===a;if(!_.isObject(r.gigPackages.templateData)||"packages"!==r.gigPackages.templateData.mode)return!1;if(r.gigPackages.templateData.alreadyClickedSave=r.gigPackages.templateData.alreadyClickedSave||d,r.gigPackages.templateData.alreadyClickedSave){var g=r.gigPackages.templateData,l=[],c=e(".js-top-header"),p=[],u=r.gigPackages.templateData.alreadyClickedSave,f="",m=[],v=parseFloat(e('[name="gig[sub_category_id]"]').val(),10),h=16===v;n.$container.find("td").removeClass("with-error"),n.$container.find(".error-message").remove();var b=o.extraFastDuration();if(_.isEmpty(b)||m.push(b),3!==fPackagesEdit.getActivePackagesCount()||h)if(h){var E=e(".js-pricing-wrapper"),C=E.find(".basic-offer-container"),y=E.find(".extras-list"),k=C.find(".js-words-included"),x=C.find(".js-additional-words"),I=C.find(".js-additional-words-price"),S=C.find(".js-delivery-time-words"),T=C.find(".js-delivery-additional-words"),w=C.find(".js-delivery-time-duration"),$=C.find(".js-price");E.find(".with-error").removeClass("with-error"),k.val()||m.push(o.formatError(k,e.t("manage_gigs.edit.basic_offer.validation.words_included"))),x.val()||parseInt(I.val())?parseInt(I.val())?x.val()||m.push(o.formatError(x,e.t("manage_gigs.edit.basic_offer.validation.additional_words"))):m.push(o.formatError(I,e.t("manage_gigs.edit.basic_offer.validation.additional_price"))):m.push(o.formatError(x.closest(".row"),e.t("manage_gigs.edit.basic_offer.validation.additional_words_and_price"))),parseInt(k.val(),10)>parseInt(S.val(),10)&&m.push(o.formatError(S,e.t("manage_gigs.edit.basic_offer.validation.delivery_words_smaller"))),S.val()||T.val()||parseInt(w.val(),10)?(S.val()||m.push(o.formatError(S,e.t("manage_gigs.edit.basic_offer.validation.delivery_words"))),T.val()||m.push(o.formatError(T,e.t("manage_gigs.edit.basic_offer.validation.delivery_words"))),parseInt(w.val())||m.push(o.formatError(w.closest(".row"),e.t("manage_gigs.edit.basic_offer.validation.delivery_time")))):m.push(o.formatError(S.closest(".row"),e.t("manage_gigs.edit.basic_offer.validation.delivery_time"))),parseInt($.val(),10)||m.push(o.formatError($,e.t("manage_gigs.edit.basic_offer.validation.price"))),y.find(".fake-hint-wrap").each(function(){var t=e(this),a="1"===t.find('input[type="checkbox"]').val(),i=t.find(".js-upgrades-price"),r=t.find(".check-text").text(),n=t.find(".js-upgrades-word"),s=t.find(".js-calc-price"),d=parseInt(s.val()),g=parseInt(n.val());if(a){if(i.length&&!parseInt(i.val())&&m.push(o.formatError(i,e.t("manage_gigs.edit.basic_offer.validation.gig_extra_price_empty",{item_name:r}))),t.hasClass("js-extra_fast")){var l=parseInt(S.val()),c=parseInt(w.val()),p=l/c;d||g?(g||m.push(o.formatError(n,e.t("manage_gigs.edit.basic_offer.validation.extra_fast_words"))),d||m.push(o.formatError(s,e.t("manage_gigs.edit.basic_offer.validation.extra_fast_price"))),p>=g&&m.push(o.formatError(n,e.t("manage_gigs.edit.basic_offer.validation.extra_fast_smaller")))):m.push(o.formatError(t,e.t("manage_gigs.edit.basic_offer.validation.extra_fast")))}t.hasClass("js-script_proofreading")&&(d||g?(g||m.push(o.formatError(n,e.t("manage_gigs.edit.basic_offer.validation.script_proofreading_words"))),d||m.push(o.formatError(s,e.t("manage_gigs.edit.basic_offer.validation.script_proofreading_price")))):m.push(o.formatError(t,e.t("manage_gigs.edit.basic_offer.validation.script_proofreading"))))}}),m.length||ft.utl.setLS("show_vo_migration_message-"+document.pageScope.gigId,!0)}else{var D=g.packages[0],j=D.packageId,P=n.$container.find('td.js-packages-title[data-package="'+j+'"]'),$=n.$container.find('td.js-packages-price[data-package="'+j+'"]'),G=n.$container.find('td.js-packages-description[data-package="'+j+'"]'),A=n.$container.find('td.js-packages-expected-duration[data-package="'+j+'"]'),N={title:u||P.data("touched"),description:u||G.data("touched"),price:u||$.data("touched"),duration:u||A.data("touched")};!D.title&&N.title&&m.push(o.formatError(P,e.t("manage_gigs.edit.gig_and_packages.validation.title_empty"))),!D.description&&N.description&&m.push(o.formatError(G,e.t("manage_gigs.edit.gig_and_packages.validation.description_empty"))),fEditGig.models.isPro&&D.price.selected&&(D.price=D.price.selected),D.price&&parseInt(D.price,10)||!N.price||m.push(o.formatError($,e.t("manage_gigs.edit.gig_and_packages.validation.price_empty"))),D.duration&&parseInt(D.duration,10)||!N.duration||m.push(o.formatError(A,e.t("manage_gigs.edit.gig_and_packages.validation.duration_empty"))),_.each(D.content,function(e){var t=n.$container.find(".js-packages-"+e.cssClassName),a=t.find('[type="number"]');a.val(parseFloat(a.val(),10))})}else _.forEach(g.packages,function(t,a){var i=n.$container.find('td.js-packages-title[data-package="'+t.packageId+'"]'),r=n.$container.find('td.js-packages-description[data-package="'+t.packageId+'"]'),d=n.$container.find('td.js-packages-price[data-package="'+t.packageId+'"]'),c=n.$container.find('td.js-packages-expected-duration[data-package="'+t.packageId+'"]'),p={title:u||i.data("touched"),description:u||r.data("touched"),price:u||d.data("touched"),duration:u||c.data("touched")};!t.title&&p.title?m.push(o.formatError(i,e.t("manage_gigs.edit.gig_and_packages.validation.title_empty"))):_.includes(l,t.title)&&p.title&&m.push(o.formatError(i,e.t("manage_gigs.edit.gig_and_packages.validation.title_duplicate"))),l.push(t.title),!t.description&&p.description&&m.push(o.formatError(r,e.t("manage_gigs.edit.gig_and_packages.validation.description_empty"))),fEditGig.models.isPro&&t.price.selected&&(t.price=t.price.selected),t.price&&parseInt(t.price,10)||!p.price?(a>0&&t.price<=g.packages[a-1].price||a>1&&t.price<=g.packages[a-2].price)&&p.price&&m.push(o.formatError(d,e.t("manage_gigs.edit.gig_and_packages.validation.price_too_low",{lowerType:g.packages[a-1].packageType,higherType:g.packages[a].packageType}))):m.push(o.formatError(d,e.t("manage_gigs.edit.gig_and_packages.validation.price_empty"))),!parseInt(t.duration,10)&&p.duration&&m.push(o.formatError(c,e.t("manage_gigs.edit.gig_and_packages.validation.duration_empty"))),_.each(t.content,function(a,i){if(a.active_for_all_or_none){var r=n.$container.find(".js-packages-"+a.cssClassName),d=n.$container.find(".js-packages-"+a.cssClassName+'[data-package="'+t.packageId+'"]'),g=d.find('[type="number"]');g.val(parseFloat(g.val(),10)),parseFloat(g.val(),10)&&(s[a.type]=s[a.type]?s[a.type]+1:1),3===t.packageId&&s[a.type]>=1&&s[a.type]<3&&m.push(o.formatError(r,e.t("manage_gigs.edit.gig_and_packages.validation.active_for_all_or_none",{item_name:a.title})))}})}),_.forEach(r.gigPackages.upgrades_per_package,function(t,a){var i=t.values[0],r=i.type.replace(/_/g,"-"),n=e(".js-upgrades");if(i.active_for_all_or_none){var s=n.find(".js-upgrade-"+r),d=0,g=s.find(".js-extra-checkbox").prop("checked");g&&(s.find(">ul >li").each(function(t,a){var i=parseFloat(e(a).find('.js-fdd-unit [type="hidden"]').val(),10);i&&d++}),3>d&&d>0&&m.push(o.formatError(s,e.t("manage_gigs.edit.gig_and_packages.validation.active_for_all_or_none",{item_name:i.title}))))}});if(r.gigPackages.upgrades_per_package&&_.forEach(r.gigPackages.upgrades_per_package,function(t,a){var i=t.type.replace(/_/g,"-"),r=e(".js-upgrades-per-package.js-upgrade-"+i),s=t.values[0].upgrade_of;if(r.removeClass("error"),s){var d=s.replace(/_/g,"-"),l=0,c=0,p=fEditGig.models.gigPackages.templateData.activePackagesCount,u=0;if(u=n.$container.find(".js-packages-"+d+' [name$="[data_value]"]'),$upgradeUnitPricingFactor=r.find('[name$="[data_value]"]'),1===p&&(u=u.first(),$upgradeUnitPricingFactor=$upgradeUnitPricingFactor.first()),_.each(u,function(t,a){parseFloat(e(t).val(),10)&&l++}),$upgradeUnitPricingFactor.each(function(){var t=e(this),a=t.closest(".upgrades-per-package-item").find(".js-upgrades-package-active");parseFloat(t.val(),10)&&parseFloat(a.val(),10)&&c++}),c>0&&2>=c&&0!=l&&3===p||c>0&&0===l&&1===p){var f=_.find(g.packages[0].content,{type:s}).title;m.push(o.formatError(n.$container.find(".js-packages-"+d),e.t("manage_gigs.edit.gig_and_packages.validation.upgrade_bound_to_package_pricing_factor",{bound:f,bound_to:t.values[0].title}))),r.addClass("error")}if(0===l&&c>0){var f=_.find(g.packages[0].content,{type:s}).title;m.push(o.formatError(n.$container.find(".js-packages-"+d),e.t("manage_gigs.edit.gig_and_packages.validation.upgrade_bound_to_package_pricing_factor",{bound:t.values[0].title,bound_to:f})))}}}),fEditGig.selectors.$pricingFactors.find("li").each(function(){var t=e(this),a="1"===t.find('input[type="checkbox"]').val(),i=t.find(".js-fdd-price"),r=t.find(".title").text(),n=0;a&&i.length&&(i.each(function(){var t=fEditGig.models.isPro?e(this).find('input[type="number"]').val():e(this).find('input[type="hidden"]').val();t&&"$"!==t&&n++}),n||m.push(o.formatError(e(".js-upgrades"),e.t("manage_gigs.edit.gig_and_packages.validation.gig_extra_price_empty",{item_name:r}))))}),fEditGig.selectors.$customExtraWrapper.length){var F=[],M=[],R=[];fEditGig.selectors.$customExtraWrapper.find(".js-gig-extra").each(function(){var t=e(this),a="1"===t.find(".js-extra-checkbox").val(),i=t.find(".js-extra-title"),r=i.val(),n=t.find(".js-fdd-price"),s=fEditGig.models.isPro?n.find('input[type="number"]').val():n.find('input[type="hidden"]').val();if(a){s&&"$"!==s||F.push(n);var o=_.size(r);0===o&&M.push(i),(_.lt(o,3)||_.gt(o,20))&&R.push(i)}}),M.forEach(function(t){m.push(o.formatError(t,e.t("manage_gigs.edit.gig_and_packages.validation.custom_gig_extra_title_required")))}),R.forEach(function(t){m.push(o.formatError(t,e.t("manage_gigs.edit.gig_and_packages.validation.custom_gig_extra_title_length")))}),F.forEach(function(t){m.push(o.formatError(t,e.t("manage_gigs.edit.gig_and_packages.validation.custom_gig_extra_price_empty")))})}return e(".js-edit-gig .with-error").removeClass("with-error"),m.length?(_.forEach(m,function(e,t){e.field&&e.field.addClass("with-error"),p.push(e.messages)}),_.forEach(_.uniq(p),function(e,t){f+="<span>"+e+"</span>"}),c.find(".js-packages-error").length?c.find(".js-packages-error .message p").html(f):Fiverr.handlePageAlerts({$alertContainer:c,autoShow:!0,escapeHTML:!1,alertData:{customClass:"js-packages-error",content:f,alertType:"error",showClose:!0}}),d&&t.scrollToError(c.find(".js-packages-error").position().top),!0):(c.find(".js-packages-error .js-btn-close-alert").trigger("click"),!1)}},requirements:function(){var t=[],a=e(".gigs-formed-requirements"),i=a.find(".requirement");return i.length<n.MIN_REQUIREMENTS&&t.push(e.t("manage_gigs.form.error.gig_requirements.requirements_min")),o.formatError(a,t)},general:function(){var e=["description","metadata"];return _.compact(_.flatten(_.map(e,function(e){return o[e]()})))},pricing:function(){var e=["extras","shipping","expectedDuration"];return _.compact(_.flatten(_.map(e,function(e){return o[e]()})))},faq_description:function(){return o.description(!0)}};t={models:{},selectors:{$doc:e(document)},init:function(){a.initSelectors(),a.initModel(),a.listenToFormEvents(),a.listenToGigChanges(),a.initNavigation(),a.showVideoUploader(),a.changePagePerSubCatId(),a.initEducationTooltips(),a.listenToGigUpcrateGalleryEvents(),a.sendMixPanelForGigUpcrateEnterance(),a.hideHelpWidget(),a.onCurrentStepInit(),a.setStudioInviteHandler(),"edit"===i.mode&&i.isSoftDenyMode&&a.showDenyReasonsAlerts(),a.fixAlertPosition()},initSelectors:function(){r.$form=e(".js-edit-gig"),r.$navigation=e(".js-gig-upcrate-steps"),r.$tabs=r.$navigation.find("a[data-for]"),r.$btnSubmit=e(".js-gig-upcrate-submit"),r.$btnDone=e(".js-btn-done"),r.$academicTermsCheckboxWrapper=e(".gig-create-confirm-academic-terms"),r.$academicTermsCheckbox=e("#confirm-academic-terms-checkbox"),r.$btnCancel=e(".js-next-back .cancel"),r.$btnBack=e(".js-next-back .back"),r.$btnSkip=e(".js-next-back .skip"),r.$or=e(".js-next-back .or"),r.$savePreview=e(".js-save-preview a"),r.$gigEditVerify=e("#gig-edit-verify"),r.$gigEditPublish=e("#gig-edit-publish"),r.$proGigToggle=e(".js-pro-gig-toggle");var t=a.getNavItem("current"),i=0===t.parent().next().length;a.checkVerificationPhoneExist(i)},initModel:function(){var e=ft.utl.getUrlVars();i.ps=Fiverr.models.ps,i.mode=_.has(e,"wizard")||i.ps.gig_is_draft?"wizard":i.ps.sub,i.manageGigsPath=i.ps.manage_gigs_path,i.hasUnsavedChanges=!1,i.denyReasonsData=document.viewData,i.isSoftDenyMode=!_.isEmpty(i.denyReasonsData),i.descriptionHasDenyReasonsError=!1,i.isBindExtraDesc=!1},getChosenCategoryID:function(){return i.chosen_category_id=i.chosen_category_id||parseInt(r.$form.find('*[name="gig[category_id]"]').val(),10)},getChosenSubCategoryID:function(){return parseInt(r.$form.find('*[name="gig[sub_category_id]"]').val(),10)},getFieldWrapper:function(e){var t=e.closest(".input-wrap, .item-cell, .gig-extra, .shipping-input-pad, .write-wrap, .gig-edit-form-section");return t.length?t:e.closest(".form-row")},validateCluster:function(e){var t=[],i=r.$form.find('section[data-name="'+e+'"]');return i.length?(_.isFunction(o[e])&&(t=t.concat(o[e]())),i.find("[name]").each(function(e,a){_.isFunction(o[a.name])&&t.push(o[a.name](a))}),t=_.compact(t),a.clusterValidationDisplay(e,t),!t.length):!1},bindTranslationExtraTextWidth:function(){var t=e(".js-gig-extra"),a=t.find(".js-extra-description"),i=t.find(".will-text");a.css({"text-indent":i.outerWidth()+8})},isMetadataHasValue:function(e){return r.$form.serializeArray().filter(function(t){return _.startsWith(t.name,e)}).map(function(e){return e.value}).some(_.identity)},bindGigsExtraTitleCounter:function(){var t=e(".js-gig-extra");t.each(function(t,a){function i(){s.text(_.size(n.val()))}var r=e(a),n=r.find(".js-extra-title"),s=r.find(".js-extra-title-counter");i(),n.on("input",i)})},bindExtraDescriptionScroll:function(){a.models.isBindExtraDesc||(e(".js-extra-description").on("scroll",function(){e(this).prev(".will-text").css({"margin-top":8-e(this).scrollTop()})}),a.models.isBindExtraDesc=!0)},validationInterrputHandler:function(e){return"pricing"===e&&"packages"===fEditGig.models.gig_pricing.mode?o.packagesMode("save"):!1},clusterValidationDisplay:function(t,n){var s,o,d="faq_description"===t&&i.descriptionHasDenyReasonsError;d||r.$form.find('[data-name="'+t+'"] .error-container').remove(),e(".char-count-desc").removeAttr("with-error"),_.each(n,a.showError),n.length>0?(o=e(".char-count-desc[with-error], .error-container:first"),a.getFieldWrapper(o).length&&a.scrollToError(a.getFieldWrapper(o).offset().top),s=_.uniq(_.flatten(_.map(n,function(e){return e.messages.join("\n")}))).join("\n"),a.getNavItem(t).parent().attr("data-hint",s)):a.getNavItem(t).parent().removeAttr("data-hint")},showError:function(t){var i,r,n,s;t&&(i='<p class="msg-error">* '+t.messages.join("<br>")+"</p>",r=e(t.field),n=a.getFieldWrapper(r),s=n.find(".error-container.upcrate-error").html(i),s.length||(s=e('<div class="error-container upcrate-error">'+i+"</div>")),n.append(s),t.messages.length<0?n.closest(".item-row, .gig-extra").find(".with-error").removeClass("with-error"):n.closest(".item-row, .gig-extra").addClass("with-error"),("gig[title]"===r.attr("name")||"gig[seo_title]"===r.attr("name"))&&_.delay(function(){n.find(".char-count-desc").attr("with-error",!0).css("color","#FF4D4D").text(t.messages.join(", "))},400))},showDenyReasonsAlerts:function(){e.each(e(".js-edit-gig > section"),function(){var t=e(this),r=t.data("section-name"),n=i.denyReasonsData[r];if(n){var s=t.data("name"),o=t.find(".js-gig-alert"),d=t.find(".js-extras-disabled"),g="description"===r?t.find("#js-gig-desc-wrap"):t.find(".js-mi-field"),l=d?e.trim(d.text()):"",c=e.t("manage_gigs.mi_tones.errors."+s),p=[{field:g,messages:[c]}],u=a.getDenyReasonErrorData(n);a.initDenyReasonsAlert(o,u.alertText,l),u.showError&&a.showDenyReasonError(s,p,g),a.redirectToTab(i.denyReasonsData,s)}})},initDenyReasonsAlert:function(e,t,a){Fiverr.handlePageAlerts({$alertContainer:e,autoShow:!0,escapeHTML:!1,prepend:!0,alertData:{content:"<ul>"+t+a+"</ul>",alertType:"error",showClose:!0,customClass:"mi-tones-page-alert"}})},getDenyReasonErrorData:function(e){var t=!1,a="";return _.each(e,function(e){e.show_error&&(t=!0),a+="<li><h4>"+e.title+"</h4><p>"+e.text+"</p></li>"}),{showError:t,alertText:a}},showDenyReasonError:function(t,r,n){"gallery"===t?o.gallery(e.t("manage_gigs.mi_tones.errors."+t)):(a.clusterValidationDisplay(t,r),n.addClass("with-error"),"faq_description"===t&&(i.descriptionHasDenyReasonsError=!0))},bindDenyReasonsValidations:function(){e(".js-mi-field").on("keypress",function(t){e(this).removeClass("with-error js-mi-field")})},removeErrorFromDescription:function(e){if(i.descriptionHasDenyReasonsError){var t=e.parent(".write-wrap.with-error");t.removeClass("with-error"),e.siblings(".error-container").remove(),i.descriptionHasDenyReasonsError=!1}},redirectToTab:function(e,t){if(1===Object.keys(e).length&&"general"!=t){var i=a.getNavItem(t);i.trigger("click")}},scrollToError:function(e){r.$doc.scrollTo(e,300)},musicAndAudioIsValid:function(){if(a.models.ps.gig_is_draft&&"gallery"!==a.getNavItem("current").data("for"))return!0;var t=document.reactGalleryData.api,i=(a.getChosenSubCategoryID(),t.audioIsValid||t.videoIsValid);return i?(r.$sectionTitle.find(".page-alert-wrap").remove(),!0):(r.$sectionTitle.find(".page-alert-wrap").length||Fiverr.handlePageAlerts({$alertContainer:r.$sectionTitle,autoShow:!0,escapeHTML:!1,alertData:{showClose:!1,content:"<ul><li>"+e.t("gig_upcrate.gallery.audio.bad_requirements")+"</li></ul>",fullWidth:!0,alertType:"error",customClass:"shown"}}),r.$doc.scrollTo({top:"0px",left:"0px"},300),!1)},validationResponse:function(e){var t=r.$form.find('[name="gig['+_.result(_.head(e.errors),"error_field")+']"]').closest("section[data-name]").data("name");r.$form.find('section[data-name="'+t+'"]').length?(r.$form.find("section[data-name]").addClass("hidden"),a.getNavItem("current").removeClass("current"),r.$form.find('section[data-name="'+t+'"]').removeClass("hidden"),a.getNavItem(t).addClass("current"),a.handleResponseErrors(e.errors)):fEditGig.showAjaxErrors(null,e.errors)},handleResponseErrors:function(e){if(0!==e.length){var t=_.head(e),i=[],n=r.$form.find('[name="gig['+t.error_field+']"]'),s=n.closest("section[data-name]");_.forEach(e,function(e){a.showError({field:r.$form.find('[name="gig['+e.error_field+']"]'),messages:[e.error_desc]}),i.push(e.error_desc)}),a.getNavItem(s.data("name")).parent().attr("data-hint",i.join("\n")),a.scrollToError(a.getFieldWrapper(n).offset().top)}},sendviewChangeEvent:function(e,t,r){var n={type:"gig_create_funnel.show",group:"gig_creation_funnel",mode:a.getGigMode(),page:a.pageData(),previous_step:e.data("index"),previous_step_name:e.data("for"),step:t.data("index"),step_name:t.data("for"),reason:r,user:[{id:i.ps.currentUser.userId}],seller:{id:i.ps.currentUser.userId},gig:{id:i.ps.gigId,category_id:i.chosen_category_id}};document.in_studio_gig_flow&&(n.studio={id:document.studio_id}),Fiverr.sendClientEvents(n)},getGigMode:function(){return"edit"===i.mode?"edit":i.ps.gig_is_draft?"draft":"new"},pageData:function(){return{name:"edit"===i.mode?"edit":"create"}},displayTriplePackageVideoPopup:function(){var t="172455672",a="step_2_creating_triple_packages",i={page:{name:"gig_create"},is_popup:!0},r={title:e.t("manage_gigs.edit.packages.popup.title"),description:e.t("manage_gigs.edit.packages.popup.sub_title")};fDashboardNew.shared.initPackagesPopup(t,a,r,i)},displayVoiceOverVideo:function(t){var a="218951778",i="voice_over_pricing_structure",r={page:{name:"gig_create"},is_popup:t},n={title:e.t("manage_gigs.edit.packages.basic_offer_popup.title"),description:e.t("manage_gigs.edit.packages.basic_offer_popup.sub_title")};fDashboardNew.shared.initPackagesPopup(a,i,n,r)},changePagePerSubCatId:function(t){var i=t||a.getNavItem("current").data("for"),r=parseFloat(e('[name="gig[sub_category_id]"]').val(),10),n=e(".old-package-section"),s=e(".new-packages-section");if("pricing"===i){if(16===r){n.addClass("hidden"),s.removeClass("hidden");var o={type:"voice_over.pricing.edit",group:"voice_over.pricing",user:[{id:Fiverr.models.user.userId}],gig:{id:document.pageScope.gigId}};ft.utl.getLS("basic_offer_vo_video")||(a.displayVoiceOverVideo(!0),ft.utl.setLS("basic_offer_vo_video",!0)),ft.utl.getLS("vo-query-gig-"+document.pageScope.gigId)||(Fiverr.sendClientEvents(o),ft.utl.setLS("vo-query-gig-"+document.pageScope.gigId,!0)),fSurveys.survey("voiceover_survey"),s.on("click",".js-open-package-intro",function(e){e.preventDefault(),a.displayVoiceOverVideo(!1)})}else n.removeClass("hidden"),s.addClass("hidden");!ft.utl.getLS("triple_package_video")&&_.includes([49],r)&&(a.displayTriplePackageVideoPopup(),ft.utl.setLS("triple_package_video",!0))}},onSubmitSuccess:function(){var e=r.$navigation.find(".current"),t=e.parent().next().find("a"),n=Fiverr.models.ps.ftg?"ftg":"regular",s=a.getNavItem("current").data("for"),o=t;"new"!==i.ps.sub&&r.$btnSubmit.removeClass("disabled").removeAttr("disabled"),"new"===i.ps.sub?(Fiverr.pushGoogleGenericTag({virtualPage:"/gig-funnel/"+n+"/"+s,event:"virtualPages"}),_.delay(function(){window.location=i.manageGigsPath+"/"+fEditGig.gigID+"/edit?wizard=1"},2e3)):"wizard"===i.mode?(Fiverr.pushGoogleGenericTag({virtualPage:"/gig-funnel/"+n+"/"+s,event:"virtualPages"}),_.delay(function(){t.removeAttr("disabled").trigger("click")},1e3),Fiverr.pushGoogleUniversalTag("Create a gig",s,null,null,{type:n,email:Fiverr.models.user.email,fullName:Fiverr.models.user.fullName})):(o=e,i.isSoftDenyMode?window.location=i.manageGigsPath:fEditGig.toggleActionBtn("saved"));var d={type:"gig.edit",group:"gig_creation_funnel",step:e.data("index"),step_name:e.data("for"),user:[{id:i.ps.currentUser.userId}],gig:{id:i.ps.gigId}};Fiverr.sendClientEvents(d),a.sendviewChangeEvent(e,o,"button")},getSelectedCategoryName:function(){return e(".js-categories-wrapper .dropdown-toggle").text().trim()},getSelectedSubCategoryName:function(){return e(".js-subcategories-wrapper .dropdown-toggle").text().trim()},getSelectedNestedSubCategoryName:function(){return e(".js-service-types-wrapper .dropdown-toggle").text().trim()},getCurrentCategories:function(){return{id:i.chosen_category_id,subId:i.chosen_sub_category_id}},reportSaveToMixPanel:function(e){var t=this;MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.SAVED_GIG_IN_CREATE_FLOW,_.merge({Category:t.getSelectedCategoryName(),"Sub-category":t.getSelectedSubCategoryName(),"Current Step":t.getCurrentNavName()},e))},listenToFormEvents:function(){var t=this;if(r.$btnCancel.on("click",function(){MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_CANCEL_IN_GIG_CREATE_FLOW,{"Current Step":t.getCurrentNavName(),"Sub-category":t.getSelectedSubCategoryName()}),location.href="/users/"+_.get(window,"Fiverr.models.user.userName")+"/manage_gigs"}),"publish"===r.$navigation.find(".current").data("for")){var a=t.getCurrentCategories();window.fetchGigAttributes(a)}r.$form.on("change",function(e){i.hasUnsavedChanges=!0,"function"==typeof o[e.target.name]&&t.showError(o[e.target.name](e.target))}),i.isSoftDenyMode&&t.bindDenyReasonsValidations(),r.$btnSubmit.on("click",function(a){if(a.preventDefault(),a.hasOwnProperty("originalEvent")){var n=r.$btnSubmit.val()===e.t("manage_gigs.form.buttons.publish_gig");n?MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.PUBLISHED_GIG_IN_CREATE_FLOW,{"Sub-category":t.getSelectedSubCategoryName()}):t.reportSaveToMixPanel({"CTA Source":"Save & Continue"})}var s=t.getNavItem("current"),o=0===s.parent().next().length;if(t.checkVerificationPhoneExist(o),Fiverr.popups.isPhoneVerify){var d=function(t){t&&(r.$gigEditVerify.addClass("hidden").removeClass("js-verify-user-publish"),r.$gigEditPublish.removeClass("hidden"),r.$btnVerify.removeClass("js-verify-user").val(e.t("manage_gigs.form.buttons.publish_gig")))};return void t.initPhoneVerificationPopup(d)}i.isSoftDenyMode?Fiverr.popups.confirmation({confirmHeader:e.t("manage_gigs.mi_tones.confirmation.title"),confirmText:e.t("manage_gigs.mi_tones.confirmation.text"),buttons:[{btnText:e.t("manage_gigs.mi_tones.confirmation.cancel")},{btnText:e.t("manage_gigs.mi_tones.confirmation.continue")}],onConfirm:function(){t.submitForm()}}):t.submitForm()});var n=function(){var t=r.$navigation.find('[data-for="publish"]'),a=r.$proGigToggle.prop("checked")?e.t("general.submit"):document.in_studio_gig_flow?e.t("manage_gigs.form.navigation_bar.invite"):e.t("manage_gigs.form.navigation_bar.publish");t.text(a)};n()},initPhoneVerificationPopup:function(t){var a={type:"newSeller",endFlowFunc:t,title:e.t("application.titles.phone_verification.verify_phone.title"),subtitlePhoneView:e.t("application.titles.phone_verification.verify_phone.subtitle"),subtitleVerifyPhoneView:e.t("application.titles.phone_verification.verify_code.subtitle"),successTitle:e.t("application.titles.phone_verification.success.title"),successSubtitle:e.t("application.titles.phone_verification.success.subtitle"),successNotification:e.t("application.titles.phone_verification.success.notification"),successButton:e.t("general.next")};Fiverr.popups.phoneVerification(a)},checkVerificationPhoneExist:function(t){return!t||Fiverr.models.ps.isMobileResponsive?void(Fiverr.popups.isPhoneVerify=!1):r.$gigEditVerify.hasClass("js-verify-user-publish")?(r.$btnVerify=r.$form.find(".js-verify-user").length?r.$form.find(".js-verify-user"):"",void(r.$btnVerify.length&&(r.$btnVerify.val(e.t("application.titles.phone_verification.exs_seller.verify_now")),Fiverr.popups.isPhoneVerify=!0,r.$gigEditVerify.removeClass("hidden")))):(Fiverr.popups.isPhoneVerify=!1,r.$gigEditPublish.removeClass("hidden"))},listenToGigChanges:function(){var e="gigUpcrate:gigChanged";document.addEventListener(e,function(e){var t=_.get(e.detail.gig,"subCategoryId");r.$academicTermsCheckboxWrapper.toggleClass("hidden",!n.ACADEMIC_DISCLAIMER_SUBCAT_IDS.includes(t))})},isAcademicTermsChecked:function(){return r.$academicTermsCheckbox.is(":checked")},shouldRequireAcademicTermsAcceptance:function(){var e=a.getChosenSubCategoryID();return!!r.$academicTermsCheckbox.length&&n.ACADEMIC_DISCLAIMER_SUBCAT_IDS.includes(e)},submitForm:function(){var n,s=r.$navigation.find(".current").parent().next().find("a"),o=e("section[data-name]:visible").data("name"),d=e(".js-requirements-dirty");if(!r.$btnSubmit.attr("disabled")){if("wizard"===i.mode&&0===s.length)return void a.publishGig(a.onSubmitSuccess);if(a.shouldRequireAcademicTermsAcceptance()&&!a.isAcademicTermsChecked())return void a.showError({field:r.$academicTermsCheckbox,messages:[e.t("manage_gigs.academic_work_disclaimer.error_message")]});n=function(){r.$sectionTitle=e(".js-gallery-wrapper .section-title-component");var t=12===a.getChosenCategoryID(),i=t?a.musicAndAudioIsValid():!0,n="gallery"===o;return i&&r.$sectionTitle.find(".page-alert-wrap").remove(),n&&!i||a.validationInterrputHandler(o)};var g="gallery"!==a.getNavItem("current").data("for");return a.validateCluster(o)&&g&&"edit"===i.mode&&!a.validateCluster("gallery")?(t.addLoader(),void setTimeout(function(){a.getNavItem("gallery").trigger("click"),t.removeLoader({saved:!1})},500)):void(a.validateCluster(o)&&!n()&&(i.hasUnsavedChanges=!1,e("#current_tab").val(a.getNavItem("current").data("for")),r.$btnSubmit.addClass("disabled").attr("disabled","disabled"),r.$savePreview.addClass("disabled").attr("disabled","disabled"),t.addLoader(),setTimeout(function(){window.studio_gig_pricing_output&&e("<input>",{type:"hidden",id:"studio_gig_pricing",name:"studio_gig_pricing",value:JSON.stringify(window.studio_gig_pricing_output)}).appendTo(r.$form),e.ajax({url:r.$form.attr("action"),type:r.$form.attr("method"),data:r.$form.serialize()}).always(function(n){var s=e.parseJSON(n.responseText),o=e('input[name="gig[sub_category_id]"]'),g=e('input[name="gig[service_type_id]"]');("new"!==document.pageScope.sub||200!==s.code)&&(r.$btnSubmit.removeClass("disabled").removeAttr("disabled"),r.$savePreview.removeClass("disabled").removeAttr("disabled")),200===s.code?(t.removeLoader({saved:!0}),"true"===d.val()&&d.val("false"),328===parseInt(o.val())&&"edit"===i.mode&&"pricing"===a.getNavItem("current").data("for")&&fSurveys.survey("chatbot_survey"),e(".flash-message").remove(),"new"===document.pageScope.sub?(s.gig_cached_slug&&(fEditGig.gigID=s.gig_cached_slug,document.pageScope.gigId=s.gig_id,fEditGig.manageGigsPath=fForms.models.forms.gigCreate.form.attr("action")),fForms.models.forms.gigCreate.form.attr("action",fEditGig.manageGigsPath+"/"+fEditGig.gigID),fForms.models.forms.gigCreate.form.append('<input type="hidden" name="_method" value="put">'),fForms.models.forms.gigCreate.form.find('input[name="retry_after_error"]').remove(),e("#gig-id").val(fEditGig.gigID),a.onSubmitSuccess()):(fEditGig.initPricing(o.val(),g.val()),t.onStudioPricingTabNavigation(),a.setHiddenInputsId(s),a.onSubmitSuccess(s))):(t.removeLoader({saved:!1}),a.validationResponse(s))})},500)))}},validatePackagesOnChange:function(){return o.packagesMode()},setHiddenInputsId:function(t){var a,i,r=t,n=e(e(".js-upgrades .js-extra-fast").length?".js-upgrades .js-extra-fast":".js-packages-extra-fast"),s=fEditGig.models.extraFastRandInd;i=_.find(r.gig_items,{fast_delivery:!0}),i&&(a=e('.js-upgrades [name="gig[gig_items_attributes]['+s+'][id]"]'),a.length||n.after('<input type="hidden" name="gig[gig_items_attributes]['+s+'][id]" value="'+i.id+'">')),r.gig_items=_.filter(r.gig_items,{custom_extra:!0}),r&&r.gig_items&&e(".js-upgrades .gig-extra.js-gig-extra").each(function(t,a){var i,n=e(a),s=n.find(".js-extra-description"),o=s.prop("name").replace("[title]","[id]"),d=e('[name="'+o+'"]').length;d||(i=_.find(r.gig_items,{title:s.val()}),"undefined"!=typeof i&&n.after('<input type="hidden" name="'+o+'" value="'+i.id+'">'))})},publishGig:function(t){return r.$btnSubmit.addClass("disabled").attr("disabled","disabled"),e(".js-send-studio-invite").addClass("disabled").attr("disabled","disabled"),r.$savePreview.addClass("disabled").attr("disabled","disabled"),i.hasUnsavedChanges=!1,window.gigUpcrateSubmitDisabled?void r.$form.find(".sub-action").text(e.t("manage_gigs.form.error.gig_failed_save")):void e.ajax({url:"./publish",type:"get",dataType:"text",success:function(t){var i,n=Fiverr.models.ps.ftg?"ftg":"regular",s=r.$proGigToggle.length&&r.$proGigToggle.prop("checked");t=e.parseJSON(t),200==t.code?(e("#gig-edit-publish").addClass("hidden"),r.$btnSubmit.addClass("hidden"),r.$btnBack.addClass("hidden"),e("#action-bar").hide(),Fiverr.pushGoogleUniversalTag("Gig Create","Gig Create - New Design","publish"),"approved"==t.gig_status?(fEditGig.gigCreateShareLinks.facebook=t.facebook_link,fEditGig.gigCreateShareLinks.twitter=t.twitter_link,fEditGig.gigCreateShareLinks.gplus=t.gplus_link,fEditGig.gigCreateShareLinks.linkedin=t.linkedin_link,fEditGig.gigCreateShareLinks.directLink=t.direct_link,fEditGig.gigCreateShareLinks.gigId=t.gig_id,document.pageScope.gig_id=t.gig_id,328===a.getChosenSubCategoryID()&&fSurveys.survey("chatbot_survey"),i=document.pageScope.ftg?"first-time-publish-gig-success":"publish-gig-success",fEditGig.populateShareButtons(),fEditGig.populatePreviewButton(),fEditGig.progressToSection("share"),s||e("#gig-edit-share").removeClass("hidden").trigger("js-tracking-open-popup")):(i=document.pageScope.ftg?"first-time-publish-gig-pending":"publish-gig-pending",s||(document.in_studio_gig_flow?e("#gig-edit-share").removeClass("hidden"):(e("#gig-edit-pending").removeClass("hidden"),fEditGig.progressToSection("pending")))),s?(e("#pro-gig-publish").removeClass("hidden"),r.$gigEditPublish.remove(),r.$btnDone.siblings(".js-btn-pro-done").removeClass("hidden"),e("#gig-edit-share").remove(),e("#gig-edit-pending").remove(),r.$btnDone.remove()):r.$btnDone.removeClass("hidden"),e("#react-gig-edit-publish").hide(),e("#gig-publish-wrapper").show(),Fiverr._debug("[fEditGig] publishGigAjax : "+i),Fiverr.pushGoogleGenericTag({virtualPage:"/gig-funnel/"+i,event:"virtualPages"}),Fiverr.pushGoogleUniversalTag("Create a gig","Published",null,null,{type:n,email:Fiverr.models.user.email,fullName:Fiverr.models.user.fullName})):(i=document.pageScope.ftg?"first-time-publish-gig-finish":"publish-gig-finish",fEditGig.progressToSection("finish"))},error:function(){r.$form.find(".sub-action").text(e.t("manage_gigs.form.error.gig_failed_save"))}})},updateInteractions:function(t){switch(i.mode){case"wizard":var n=a.getNavItem("current"),s=0===n.parent().next().length,o=("pricing"===n.data("for"),"gallery"===n.data("for"),"requirements"===n.data("for"),0===n.parent().prev().length),d=!0;if(s){if(!Fiverr.popups.isPhoneVerify){var g=r.$proGigToggle.length&&r.$proGigToggle.prop("checked")?e.t("general.submit"):e.t("manage_gigs.form.buttons.publish_gig");r.$btnSubmit.val(g)}}else r.$btnSubmit.val(e.t("manage_gigs.form.buttons.save_continue"));r.$btnBack.toggleClass("hidden",o),r.$btnSkip.toggleClass("hidden",d),r.$or.toggleClass("hidden",d)}},getNavItem:function(e){switch(e){case"current":return r.$navigation.find("a.current");case"next":case"prev":return r.$navigation.find("a.current").parent()[e]().find("a");default:return r.$navigation.find('a[data-for="'+e+'"]')}},getCurrentNavName:function(){var e=this;return e.getNavItem("current").text().trim()},showVideoUploader:function(){var e=this;/#video/.test(document.location.href)?_.delay(function(){e.getNavItem("gallery").trigger("click")},250):/#gig-edit-upload-video/.test(document.location.href)&&_.delay(function(){e.getNavItem("gallery").trigger("click")},250)},initNavigation:function(){var t=this,a=e(".js-save-preview");e("#main-wrapper-header").append(e(".upcrate-page").removeClass("hidden")),a.on("click",".save",function(e){e.preventDefault(),e.hasOwnProperty("originalEvent")&&t.reportSaveToMixPanel({"CTA Source":"Save"}),r.$btnSubmit.trigger("click"),Fiverr.pushGoogleUniversalTag("upcrate","click","save")}),a.on("click",".save-and-preview",function(a){var i=e("section[data-name]:visible").data("name"),n=!t.validateCluster(i);a.hasOwnProperty("originalEvent")&&t.reportSaveToMixPanel({"CTA Source":"Save & Preview"}),r.$btnSubmit.trigger("click"),n?(a.preventDefault(),Fiverr.pushGoogleUniversalTag("upcrate","click","try_save_preview")):Fiverr.pushGoogleUniversalTag("upcrate","click","save_preview")}),r.$navigation.attr("data-mode",i.mode).on("click","a[data-for]",function(a){a.preventDefault(),r.$btnSubmit.removeClass("disabled").removeAttr("disabled");var n=e(a.target),s=n.data("for"),o=t.getNavItem("current"),d=o.data("for"),g="publish"===s,l=o.data("index"),c=n.data("index"),p="gallery"===s;if(!n.attr("disabled")&&s&&s!==d){if(g){var u=t.getCurrentCategories();window.fetchGigAttributes(u)}if(a.hasOwnProperty("originalEvent")&&MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_PROGRESS_BAR_LINKS_IN_GIG_CREATE_FLOW,{"Sub-category":t.getSelectedSubCategoryName(),"Source Step":d,"Target Step":s}),t.checkVerificationPhoneExist(g),"faq_description"===s&&!t.models.isEditorInit){var f={keyup:t.removeErrorFromDescription};fEditGig.initTextEditor("gig_description",!1,!1,f),i.descriptionHasDenyReasonsError&&e(".gig-edit-editor-wrap").addClass("with-error"),t.models.isEditorInit=1}t.changePagePerSubCatId(s),l>c||t.validateCluster(d)?(o.addClass("valid").removeClass("current").parent().removeAttr("data-hint"),n.addClass("current"),r.$form.find('section[data-name="'+d+'"]').addClass("hidden"),r.$form.find('section[data-name="'+s+'"]').removeClass("hidden"),t.sendviewChangeEvent(o,n,"breadcrumbs"),"pricing"===s&&(t.bindTranslationExtraTextWidth(),t.bindExtraDescriptionScroll()),t.stepDidEntered(s),r.$doc.scrollTo(0,300),t.updateInteractions(),e("body").toggleClass("hide-answers-widget",!p)):o.removeClass("valid")}}),r.$btnBack.on("click",function(e){e.preventDefault(),MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_BACK_IN_GIG_CREATE_FLOW,{"Sub-category":t.getSelectedSubCategoryName(),"Current Step":t.getCurrentNavName()}),t.getNavItem("prev").removeAttr("disabled").trigger("click")}),r.$btnSkip.on("click",function(e){e.preventDefault(),t.getNavItem("next").removeAttr("disabled").trigger("click")}),t.updateInteractions(),e("#current_tab").val(t.getNavItem("current").data("for"))},stepDidEntered:function(t){var a=this;switch(document.in_studio_gig_flow&&"publish"===t?e(".js-next-back").hide():e(".js-next-back").show(),t){case"studio_pricing":a.onStudioPricingTabNavigation();break;case"studio_services":a.onStudioServicesTabNavigation()}},onStudioServicesTabNavigation:function(){var e,t="gig_upcrate::services";"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1)),document.dispatchEvent(e)},onStudioPricingTabNavigation:function(){var e,t="gig_upcrate::pricing";"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1)),document.dispatchEvent(e)},onCurrentStepInit:function(){var e=this,t=e.getNavItem("current").data("for");e.stepDidEntered(t)},setStudioInviteHandler:function(){e(".js-send-studio-invite").on("click",function(){e(".js-gig-upcrate-submit").click()})},fixAlertPosition:function(){var t,a=e(".db-top-nav-bar"),i=e(".js-db-edit-gig");window.bridge.subscribe(function(e){"ACTIVATE_USER_DID_MOUNT"==e.type&&(t=Fiverr.selectors.$bombaMessage,t.length&&a.length&&(t.css("margin-top",a.outerHeight()+"px"),i.removeClass("p-t-50")))})},addLoader:function(){var t=e("section[data-name]:visible"),a=e.t("manage_gigs.form.loader.loading"),i='<div class="loader-overlay"><div class="loader">'+a+"</div></div>";t.prepend(i)},removeLoader:function(t){var a=e("section[data-name]:visible .loader-overlay"),i=a.find(".loader");return t.saved?(i.addClass("completed").text(e.t("manage_gigs.form.loader.completed")),void _.delay(function(){a.remove()},1500)):void a.remove()},listenToGigUpcrateGalleryEvents:function(){var e=this;document.addEventListener("gigUpcrateGallery:clicked-photo-experts-link",function(){MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_PHOTO_EXPERTS_LINK,{"Sub-category":e.getSelectedSubCategoryName(),"Nested Sub-category":e.getSelectedNestedSubCategoryName()})})},sendMixPanelForGigUpcrateEnterance:function(){var e=_.get(window,"fGigsUpcrate.models.mode"),t=_.get(window,"fGigsUpcrate.models.ps.gig_is_draft");MixpanelWrapper.trackEvent(MixpanelWrapper.Events.GigUpCreateEvents.OPEN_GIG_UPCRATE_FLOW,{Mode:"wizard"===e?"new gig":"edit gig",Draft:t})},hideHelpWidget:function(){e("body").addClass("hide-answers-widget")},initEducationTooltips:function(){var t=e(".edit-gig-form-wrap");t.on("click",".js-education-video",function(t){t.preventDefault();var r=t.target.className,n="",s="",o="";r.includes("overview")&&(n="overview",o="step_1_overview",i.ps.videoId="230900398"),r.includes("policy-video-button")&&(n="gig_videos_policy",o="general_gig_policy",i.ps.videoId="283703560",s=e.t("gig_upcrate.education_tooltip."+n+".popup_description")),r.includes("description")&&(n="description",o="step_3_description_faq",i.ps.videoId="230900703"),r.includes("requirements")&&(n="requirements",o="step_4_requirements",i.ps.videoId="230900952"),r.includes("gallery")&&(n="gallery",o="step_5_gallery",i.ps.videoId="230901157");var d={title:e.t("gig_upcrate.education_tooltip."+n+".title"),description:s||e.t("gig_upcrate.education_tooltip.popup_description")},g={page:{name:"gig_create"},gig:{id:i.ps.gigId}};a.sendMixPanelVideoEvent(n),fDashboardNew.shared.initPackagesPopup(null,o,d,g)}),e(".js-edit-gig").find(".form-row, .fake-hint-wrap").on("mouseenter",function(){e(".js-sticky-tooltip").addClass("hidden")}).on("mouseleave",function(){e(".js-sticky-tooltip").removeClass("hidden")})},sendMixPanelVideoEvent:function(e){var t=MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_OVERVIEW_VIDEO;switch(e){case"overview":t=MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_OVERVIEW_VIDEO;break;case"description":t=MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_DESCRIPTION_VIDEO;break;case"requirements":t=MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_REQUIREMENTS_VIDEO;break;case"gallery":t=MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_GALLERY_VIDEO;break;default:t=MixpanelWrapper.Events.GigUpCreateEvents.CLICKED_OVERVIEW_VIDEO}MixpanelWrapper.trackEvent(t)}},window.fGigsUpcrate=a=t,i=a.models,r=a.selectors,r.$doc.ready(t.init)}(jQuery);