!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sellerTestsGigCreate=t():e.sellerTestsGigCreate=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=806)}({11:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e){return"object"===("undefined"==typeof Fiverr?"undefined":n(Fiverr))&&"function"==typeof Fiverr[e]?!0:void 0};t.alias=function(e){return function(){var t;return s(e)&&(t=Fiverr)[e].apply(t,arguments)}}},396:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(52),l=r(805),c=n(l);r(500);var d=function(e){function t(e){s(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.gigPublishWrapper=document.getElementById("gig-publish-wrapper"),r.gigUpcrateSubmit=document.querySelector(".js-gig-upcrate-submit"),r.constructor.boundFunctions.forEach(function(e){return r[e]=r[e].bind(r)});var n=Fiverr.models.ps.gigId,a=document.reactOverviewData.category.categoryId,o=document.reactOverviewData.category.subCategoryId;return r.state={loadingTests:!0,relevantTests:[],passedTests:[],gigId:n,catId:a,subCatId:o,gigAttributesUrl:"/manage_gigs/gig_attributes?sub_cat_id="+o+"&gig_id="+n},window.fetchGigAttributes=r.fetchGigAttributes,window.gigUpcrateSubmitDisabled=!1,r}return a(t,e),o(t,null,[{key:"boundFunctions",get:function(){return["fetchGigAttributes","getRelevantTest","runTest"]}}]),o(t,[{key:"fetchGigAttributes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.state,n=r.gigId,s=r.gigAttributesUrl,i=t.id,a=t.subId;if(n){var o=i||document.reactOverviewData.category.categoryId,u=a||document.reactOverviewData.category.subCategoryId;this.setState({catId:o,subCatId:u},function(){$.getJSON(s,e.getRelevantTest)})}}},{key:"getRelevantTest",value:function(e){var t=this,r=this.state,n=r.subCatId,s=r.catId,i=(_.find(e.extended,{name:"language"})||{}).options,a=_.filter(i,{selected:!0}),o=decodeURIComponent($.param({metadata_languages:a.map(function(e){return e.name})})),u="required_tests_status?category_id="+s+"&sub_category_id="+n+"&"+o;gofor(u).then(function(e){return e.json()}).then(function(e){var r=e.relevant_tests.concat(e.tests_data).reduce(function(e,t){return e[t.id]=Object.assign(e[t.id]||{},t),e},{}),n=_.values(r),s=_.remove(n,{passed:!0});(n.length>0||s.length>0)&&(t.gigPublishWrapper.style.display="none"),0===n.length&&0===s.length&&(t.gigUpcrateSubmit.removeAttribute("disabled"),t.gigUpcrateSubmit.classList.remove("disabled"),t.gigPublishWrapper.style.display="block",window.gigUpcrateSubmitDisabled=!1),n.length>0&&(t.gigUpcrateSubmit.setAttribute("disabled",!0),t.gigUpcrateSubmit.classList.add("disabled"),window.gigUpcrateSubmitDisabled=!0),t.setState({relevantTests:n,passedTests:s,loadingTests:!1})})}},{key:"runTest",value:function(e){var t=this.state,r=t.catId,n=t.subCatId;u.sendEvents({group:"gig_creation_funnel",type:"manage_gigs.clicked_on_take_test",user:{id:Fiverr.models.user.userId},seller:{id:Fiverr.models.user.userId},gig:{id:Fiverr.models.ps.gigId,category_id:r,category_name:Fiverr.models.ps.categories.initial,sub_category_id:n,sub_category_name:Fiverr.models.ps.subcategories.initial,step:"6",previous_step:"5",step_name:"Publish",previous_step_name:"Gallery"}}),gofor("take_test",{method:"POST",body:JSON.stringify({test_id:e,user_id:Fiverr.models.user.userId,step_id:5,platform_name:"expert_rating"})}).then(function(e){return e.json()}).then(function(e){e.success&&(location.href=e.url)})}},{key:"render",value:function(){var e=this,t=Fiverr.models.ps.currentUser.fullName,r=this.state,n=r.loadingTests,s=r.relevantTests,i=r.passedTests;return 0===s.length&&0===i.length?null:React.createElement("section",{className:"seller-tests-before-publish"},React.createElement("h2",null,$.t("gig_upcrate.skill_tests_before_publish.youre_almost_there"),", ",t,"!",React.createElement("p",null,$.t("gig_upcrate.skill_tests_before_publish.before_selling"))),React.createElement("h3",null,$.t("gig_upcrate.skill_tests_before_publish.quality_is_important")),n&&React.createElement("div",null,$.t("gig_upcrate.skill_tests_before_publish.loading_tests")),i.map(function(e){var t=e.id,r=e.name;return React.createElement("div",{className:"test-section passed-test",key:t},React.createElement("div",{className:"test-data"},React.createElement("h4",null,React.createElement("i",{className:"fa fa-check"}),r," ",$.t("gig_upcrate.skill_tests_before_publish.test"),React.createElement("p",null,$.t("gig_upcrate.skill_tests_before_publish.thanks_for_completing")))))}),s.map(function(t){return React.createElement(c["default"],{key:t.id,test:t,onClick:function(){return e.runTest(~~t.id)}})}))}}]),t}(React.Component);t["default"]=d,e.exports=t["default"]},499:function(e,t){},500:function(e,t){},52:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendEvents=void 0;var n=r(11);t.sendEvents=n.alias("sendClientEvents")},805:function(e,t,r){"use strict";function n(e){var t=e.nextRetake,r=$.t("gig_upcrate.skill_tests_before_publish.hours"),n=$.t("gig_upcrate.skill_tests_before_publish.days"),s=t/36e5>24,i=864e5,a=36e5,o=s?i:a,u=Math.ceil(t/o)+" "+(s?n:r);return React.createElement("p",{className:"error-msg"},$.t("gig_upcrate.skill_tests_before_publish.remain_draft"),t>0&&" "+$.t("gig_upcrate.skill_tests_before_publish.wait",{time:u}))}function s(e){var t=e.test,r=e.onClick,s=t.id,i=t.name,a=t.description,o=t.next_allowed_retake_date,u=t.tests_taken_count,l=t.is_allowed_to_take_test,c=(new Date).getTime()-new Date(1e3*o),d=u>0?$.t("gig_upcrate.skill_tests_before_publish.retake_test"):$.t("gig_upcrate.skill_tests_before_publish.take_test");return React.createElement("div",{className:"test-section"},React.createElement("div",{className:"test-data"},React.createElement("h4",null,i," ",$.t("gig_upcrate.skill_tests_before_publish.test"),!l||u>0?React.createElement(n,{nextRetake:c}):React.createElement("p",null,a||$.t("gig_upcrate.skill_tests_before_publish.english_description")))),React.createElement("input",{type:"button",className:"button-standard",onClick:function(){return r(s)},value:d}))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0,r(499),t["default"]=s,e.exports=t["default"]},806:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var s=r(396),i=n(s),a=document.getElementById("react-gig-edit-publish");a&&ReactDOM.render(React.createElement(i["default"],null),a)}})});